Nuclei is a fast, open-source, and highly customizable vulnerability scanner that uses simple YAML-based templates to automate security scanning across different protocols. It is widely used by security professionals to detect vulnerabilities efficiently and accurately with community-contributed templates and integration-friendly architecture.

## Key Features of Nuclei

- Customizable YAML-based templates for defining vulnerability detection rules
- High-speed scanning engine written in Go for efficiency and scalability.
- Supports multiple protocols: HTTP, DNS, TCP, SSL, WHOIS, file, headless browser, and more
- Large repository of community-contributed templates covering various vulnerabilities and misconfigurations
- Easy integration with CI/CD pipelines and other reconnaissance tools.
- Supports automation, workflows, filtering by severity, tags, and custom scanning profiles

## Components

### Nuclei Engine

- Acts as the core framework of the scanning tool
- Handles sending requests, receiving responses, and applying matching logic.
- Built with concurrency to scan multiple targets simultaneously
- Supports a wide range of protocols, such as HTTP, HTTPS, DNS, FTP, and SSH
- Offers configuration options like timeouts, retries, and proxy settings for performance tuning.
- Written in Go, making it efficient, cross-platform, and scalable

### Nuclei Templates

- Define the actual scanning logic in a structured and reusable way
- Describe vulnerabilities or checks to be tested against targets.
- Written in YAML, making them easy to read, customize, and extend.
- Cover multiple areas such as vulnerability detection, misconfigurations, brute force attempts, and information gathering.
- Come with a rich library of pre-existing templates while allowing users to create custom ones.
- Template-driven design makes the tool flexible and adaptable to new security issues

## Installation and Update

### Install Nuclei via Go:

```
go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest

```

```
cp -v /root/go/bin/nuclei /usr/local/bin/nuclei

```

```
chmod +x /usr/local/bin/nuclei

```

```
ls -lh /usr/local/bin/nuclei

```

### Update engine:

```
nuclei -up

```

### Update templates:

```
nuclei -ut

```

## Creating Custom Templates

Creating custom Nuclei templates involves writing simple YAML files that define how Nuclei should interact with targets to detect vulnerabilities, gather information, or test for specific conditions based on requests and matchers.

These templates are extremely flexible, lightweight, and easy to develop or modify.

Here is a structured guide and examples based on the information and common patterns from the official sources and repositories:

### Basics of a Nuclei Template

- Templates use YAML format to describe:
- Id: Unique template identifier
- Info: Metadata including name, author, severity
- Requests: Defines network requests to send (HTTP methods, paths).
- Matchers: Defines conditions for matching responses (word presence, status codes, regex)
- Templates can be protocol-specific (HTTP, DNS, FTP, etc.).
- Variables like {{BaseURL}} make templates reusable for targets.

### Resources

- https://github.com/projectdiscovery/nuclei-templates
- https://nuclei.projectdiscovery.io/templating-guide/
- https://www.yamllint.com/
- https://github.com/sudo-jtcsec/public-nuclei-templates/tree/main/bugs-misconfigs
- https://nuclei.projectdiscovery.io/template-examples/http/

Here is a structured guide and examples based on the information and common patterns from the official sources and repositories:

### Example: Robots File Check

```
vim robots-check.yaml

```

```
id: Robots-check

info:
  name: robots File Check
  author: rahul
  severity: info

requests:
  method: GET
  path:
    - "{{BaseURL}}/robots.txt"
matchers:
  type: word
  words:
    - "Disallow"

```

This checks the presence of "Disallow" in the robots.txt file response, indicating restricted paths.

```
nuclei -u <http://192.168.1.51> -t my-templates/pmyadmin-panel.yaml

```

```
vim robots-check2.yaml

```

```
id: Robots-check

info:
  name: robots File Check
  author: Armour
  severity: info

requests:
  method: GET
  path:
    - "{{BaseURL}}/robots.txt"

matchers:
  type: status
  status:
    - 200

```

This checks the presence of "Disallow" in the robots.txt file response, indicating restricted paths.

```
nuclei -u <http://192.168.1.51> -t my-templates/robots-check.yaml

```

### Example: Phpinfo Page Detection

```
vim phpinfo-page.yaml

```

```
id: phpinfo-page

info:
  name: Phpinfo Page
  author: Armour Infosec
  severity: info

requests:
  method: GET
  path:
    - "{{BaseURL}}/phpinfo.php"
    - "{{BaseURL}}/info.php"
    - "{{BaseURL}}/pinfo.php"
  stop-at-first-match: true
matchers:
  type: word
  words:
    - "PHP Version"
    - "PHP License"
    - "www.zend.com"
  condition: and
  type: status
  status:
    - 200
    - 301
matchers-condition: and

```

```
nuclei -u <http://192.168.1.235> -t phpinfo-page.yaml

```

### Example: CMS API Endpoint Check

```
vim cuppa-cms.yaml

```

```
id: CuppaCMS

info:
  name: CuppaCMS
  author: vsachin168
  severity: info

requests:
  method: GET
  path:
    - "{{BaseURL}}/cuppa/api/index.php"
matchers:
  type: status
  status:
    - 200
    - 301
    - 400
    - 401
    - 403
    - 500

```

### FTP Templates

Nuclei supports FTP through raw TCP interactions or protocol-specific templates.

Example FTP templates can check for:

- Anonymous login enabled.
- Banner grabbing for FTP server fingerprinting.
- Misconfigurations or exposed FTP panels.

FTP templates often check welcome messages or response codes for vulnerabilities or common server banners.

Example FTP anonymous login check snippet concept:

```
vim ftp-anonymous-login.yaml

```

```
id: ftp-anonymous-login

info:
  name: FTP Anonymous Login Allowed
  author: community
  severity: medium

requests:
  raw:
    - |
      USER anonymous
      PASS anonymous

matchers:
  type: status
  status:
    - 230
  type: word
  words:
    - "230 Login successful"

```

### MySQL Templates

Templates for MySQL usually involve testing for exposed or misconfigured MySQL servers.

They may:

- Attempt to connect to MySQL TCP port.
- Check responses for banner or error strings indicating version or exposed service.
- Credential brute forcing is also a use case, similar to SSH.

A simple MySQL version fingerprinting template may send raw TCP payloads and analyze responses, though specifics depend on nuclei's network template features.

A simple MySQL version fingerprinting template may send raw TCP payloads and analyze responses, though specifics depend on nuclei's network template features.

```
vim mysql-default-login.yaml

```

```
id: mysql-default-login
info:
  name: MySQL Default Login
  author: DhiyaneshDk, pussycat@x,ritikchaddha
  severity: high
  description: A MySQL service was accessed with easily guessed credentials.
  metadata:
    verified: true
    max-request: 21
    shodan-query: "port:3306"
  tags: js,mysql,default-login, network, fuzz,enum
javascript:
  pre-condition: |
    isPortOpen (Host, Port);
  code: |
    var m = require("nuclei/mysql");
    var c = m.MySQLClient();
    c.Connect(Host, Port, User, Pass)
  args:
    Host: "{{Host}}"
    Port: "3306"
    User: "{{usernames}}"
    Pass: "{{passwords}}"
payloads:
  usernames:
    - root
    - admin
    - mysql
    - test
  passwords:
    - root
    - admin
    - mysql
    - test
attack: clusterbomb
matchers:
  type: dsl
  dsl:
    - "response true"
    - "success = true"
  condition: and

```

## Tools for Creating and Validating Templates

- Use YAMLLint for syntax checking.
- The official Nuclei Templating Guide offers detailed documentation.
- Refer to the Nuclei Templates GitHub repository for community-curated examples and contributions.
- Public repos like sudo-jtcsec's public-nuclei-templates provide additional template examples for bugs and misconfigurations.

## Basic Usage Examples

Scan a single target (can be a website or IP address):

```
nuclei -target <https://example.com>

```

```
nuclei -target <http://192.168.1.235>

```

```
nuclei -target <http://192.168.1.150>

```

Scan multiple targets from a file (targets.txt contains one URL/IP per line):

```
nuclei -l targets.txt

```

Use Naabu to scan ports silently for multiple hosts, then pass results to Nuclei to scan for vulnerabilities:

```
naabu -silent -host 192.168.1.150,192.168.1.235 -o naabu-output.log

```

```
nuclei -l naabu-output.log -o nuclei-output.log

```

Scan a target using specific template directories (e.g., templates for exposed admin panels):

```
nuclei -target <https://example.com> -t /root/nuclei-templates/http/exposed-panels/

```

## Advanced Usage

Use tags to filter templates by severity or category:

```
nuclei -target <https://example.com> -s high,critical

```

```
nuclei -target <https://example.com> -tags cves,dns

```

Run workflows for complex scanning scenarios:

```
nuclei -l targets.txt -workflows /root/nuclei-templates/workflows/default-application-workflow.yaml

```

Pipe port scan results (using Naabu) directly into Nuclei for vulnerability scanning:

```
naabu -p -host 192.168.1.51 -silent | nuclei

```

Scan targets for HTTP exposure issues:

```
nuclei -l bee-box.txt -t /root/nuclei-templates/http/exposures/

```

Scan targets for exposed admin panels:

```
nuclei -l bee-box.txt -t /root/nuclei-templates/http/exposed-panels/

```

Identify default login portals on targets:

```
nuclei -l bee-box.txt -t /root/nuclei-templates/http/default-logins/

```

Scan IP list with all available templates:

```
nuclei -t /root/nuclei-templates -l ip.txt

```

Same as above, with verbose output enabled:

```
nuclei -t /root/nuclei-templates -l ip.txt -v

```

Scan specified ports for exposed phpMyAdmin panels:

```
nuclei -l /home/armour/Downloads/192.168.1.51-ports.txt -t /root/nuclei-templates/exposed-panels/phpmyadmin-panel.yaml

```

Scan specified ports for any exposed admin panels:

```
nuclei -l /home/armour/Downloads/192.168.1.51-ports.txt -t /root/nuclei-templates/exposed-panels/

```

Scan localhost on port 8080 using all templates:

```
nuclei -u 127.0.0.1:8080 -t /root/nuclei-templates/

```

Scan a single target for exposed admin panels:

```
nuclei -u 192.168.1.51:80 -t /root/nuclei-templates/exposed-panels

```

Perform HTTP fuzzing scans with verbose output:

```
nuclei -l bee-box.txt -v -t nuclei-templates/http/fuzzing/

```

Scan for network vulnerabilities on targets:

```
nuclei -l bee-box.txt -t /root/nuclei-templates/network/vulnerabilities/

```

Use new templates in scanning:

```
nuclei -l bee-box.txt -new-templates

```

Run automatic pre-configured scans on targets:

```
nuclei -l bee-box.txt -automatic-scan

```

Run workflows for complex scanning scenarios:

```
nuclei -l bee-box.txt -workflows /root/nuclei-templates/workflows/default-application-workflow.yaml

```

Detect technologies used by a website:

```
nuclei -u <https://www.thehackersworld.com/> -t /root/nuclei-templates/http/technologies/

```

Detect specific server technology versions and known CVEs, output JSON:

```
nuclei -l 192.168.1.51-ports.txt -t /root/nuclei-templates/technologies/nginx/nginx-version.yaml,/root/nuclei-templates/cves/2021/CVE-2021-30497.yaml -je output.json

```

Find templates related to phpMyAdmin in template directory:

```
find /root/nuclei-templates -iname phpmyadmin

```

Scan a host for CVE vulnerabilities with selected severity filters:

```
nuclei -u 192.168.1.26:80 -tags cves -s critical

```

Run WordPress workflow scan and output JSON results:

```
nuclei -u <https://www.armourinfosec.com> -t nuclei-templates/workflows/wordpress-workflow.yaml -je test2.json

```

Pipe port scan results (using Naabu) directly into Nuclei for vulnerability scanning:

```
naabu -p -host 192.168.1.51 -silent | nuclei

```

## Cent Tool

The "cent" tool is a community edition nuclei templates manager that allows organizing and managing all the Nuclei templates provided by the community in a single place. It is useful for security testing by running Nuclei scans with a comprehensive set of community templates.

### Features and Usage of Cent

- Install via Go or download from releases
- Use cent init to initialize configuration
- Update template repositories with cent update
- Check availability of template repos with cent check
- Summarize collection statistics using cent summary.
- Validate templates to ensure validity
- Configure with .cent.yaml file specifying folders, excludes, and template sources.
- Integrates with Nuclei scanner for automated vulnerability scanning using community templates.

### Example Workflow

1. Initialize cent:

```
cent init

```

1. Update templates:

```
cent update

```

1. Run Nuclei scan using community templates collected by cent:

```
nuclei -u <https://target-url> -t /path/to/cent-nuclei-templates -tags cve

```

1. Use summary for template statistics:

```
cent summary

```

### Commands and Flags

- cent init - Initialize cent with configuration
- cent update - Update repository templates.
- cent summary - Show template statistics.
- cent check - Verify repo availability.
- Global flags include -config for custom config file, -p for path root directory, and -l for number of cloning threads

### Integration Example Commands

Scan target with CVE-related templates:

```
nuclei -u <https://www.armourinfosec.com> -t /root/cent-nuclei-templates -tags cve

```

Scan host excluding certain tags, e.g., SSL and network:

```
nuclei -u <https://www.armourinfosec.com> -t /root/cent-nuclei-templates/ -es info -etags ssl,network

```

This tool efficiently centralizes community Nuclei templates and can directly be used with Nuclei scanner to simplify and enrich vulnerability scanning by leveraging community-driven templates in organized repositories.
